function formatData(e){var t={};for(key in e[0])"Name"!==key&&(t[key]={});e.forEach(function(e,a){normalizeData(e);for(key in e)"name"!==key&&("undefined"==typeof t[key][e.name]&&(t[key][e.name]={}),t[key][e.name]=e[key])}),buildDataViz(t)}function normalizeData(e){var t={},a=[];for(key in e)"name"!==key&&a.push(e[key]);var i=Math.max.apply(Math,a);for(key in e)maxHelper[e.name]=i}function buildCircle(e,t){var a=document.createElementNS("http://www.w3.org/2000/svg","circle");return e.setAttribute("name",t.key),console.log(visualisationData,[t.key]),t.radius>=minRadius?a.radius=maxRadius*t.radius/100:a.radius=maxRadius*minRadius/100,e.appendChild(a),a.setAttribute("cx",t.x),a.setAttribute("cy",t.y),a.setAttribute("r",a.radius),a.setAttribute("name",t.name),a}function getPercentageOfKey(e,t){var a=100*t[e]/maxHelper[e];return a}function buildDataViz(e){var t="http://www.w3.org/2000/svg",a=1200,i=1200,n={x:100,y:100},r=document.createElementNS(t,"svg");r.setAttributeNS(null,"viewBox","0 0 "+a+" "+i),r.setAttributeNS(null,"width",a),r.setAttributeNS(null,"height",i),r.style.display="block",document.body.appendChild(r);var s={};for(key in e)"name"!==key&&(console.log(e[key].x,e[key].y),s={key:statistikKey,x:e[key].x+n.x,y:e[key].y+n.y,radius:getPercentageOfKey(statistikKey,e[key]),name:key},e[key].circle=buildCircle(r,s));visualisationData=e}function changeKey(e){if(e!==statistikKey)for(key in visualisationData)if("name"!==key){var t=visualisationData[key].circle.radius,a=getPercentageOfKey(e,visualisationData[key]);animateValues(t,a,visualisationData[key].circle),visualisationData[key].circle.radius=a,statistikKey=e}}function actionButton(e){changeKey(this.name)}function animateValues(e,t,a){var i={wert:e},n={wert:t},r=new TWEEN.Tween(i).to(n,1e3).onUpdate(function(){console.log(this.wert),this.wert>=minRadius?a.setAttribute("r",maxRadius*this.wert/100):a.setAttribute("r",maxRadius*minRadius/100)}).easing(TWEEN.Easing.Back.In).start()}function animate(e){requestAnimationFrame(animate),TWEEN.update(e)}var statistikKey="gegentore",maxHelper={},maxRadius=70,minRadius=10,visualisationData={},options=["tore","gegentore","spielanzahl","alter","rot","gelb","qualifikationen","marktwert","kader","punkte","siege","gastgeber","twitter","landsize"],xmlhttp=new XMLHttpRequest,url="data.json";xmlhttp.onreadystatechange=function(){if(4==xmlhttp.readyState&&200==xmlhttp.status){var e=JSON.parse(xmlhttp.responseText);formatData(e[0])}},xmlhttp.open("GET",url,!0),xmlhttp.send();var buttonHolder=document.getElementById("options");options.forEach(function(e,t){var a=document.createElement("button");a.name=e,a.innerHTML=e,a.addEventListener("click",actionButton),buttonHolder.appendChild(a)}),requestAnimationFrame(animate);