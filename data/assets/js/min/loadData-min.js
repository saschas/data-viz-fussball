function formatData(e){var t={};for(key in e[0])"name"!==key&&(t[key]={});e.forEach(function(e,a){normalizeData(e);for(key in e)"name"!==key&&("undefined"==typeof t[key][e.name]&&(t[key][e.name]={}),t[key][e.name]=e[key])}),buildDataViz(t)}function normalizeData(e){var t={},a=[];for(key in e)"name"!==key&&a.push(e[key]);var i=Math.max.apply(Math,a);for(key in e)maxHelper[e.name]=i}function buildCircle(e,t){var a=document.createElement("div");e.setAttribute("name",t.key),console.log(visualisationData,[t.key]),t.radius>=minRadius?a.radius=maxRadius*t.radius/100:a.radius=maxRadius*minRadius/100,a.msg=t.msg,e.appendChild(a),a.classList.add("bubbles");var i="background-image:url(assets/ico/"+capitalizeFirstLetter(t.name)+".svg);";return a.setAttribute("style","position:absolute;top:"+.1*t.y+"%;"+i+"left:"+.1*t.x+"%;transform: translateX(-50%) translateY(-50%); width:"+a.radius+"px;height:"+a.radius+"px;"),a.setAttribute("name",t.name),a}function getPercentageOfKey(e,t){var a=100*t[e]/maxHelper[e];return a}function buildDataViz(e){var t="http://www.w3.org/2000/svg",a=1200,i=1200,n={x:100,y:100},s=document.createElement("div");s.width=window.innerWidth,s.height=window.innerHeight,s.classList.add("holder"),s.style.display="block",document.body.appendChild(s);var r={};for(key in e)"name"!==key&&(console.log(e[key].x,e[key].y),r={key:statistikKey,x:e[key].x+n.x,y:e[key].y+n.y,radius:getPercentageOfKey(statistikKey,e[key]),name:key,msg:"hallo ",color:getRandomColor()},e[key].circle=buildCircle(s,r));visualisationData=e}function getRandomColor(){for(var e="0123456789ABCDEF".split(""),t="#",a=0;6>a;a++)t+=e[Math.floor(16*Math.random())];return t}function changeKey(e){if(e!==statistikKey)for(key in visualisationData)if("name"!==key){var t=visualisationData[key].circle.radius,a=getPercentageOfKey(e,visualisationData[key]);animateValues(t,a,visualisationData[key].circle),visualisationData[key].circle.radius=a,statistikKey=e}}function actionButton(e){changeKey(this.name)}function animateValues(e,t,a){var i={wert:e},n={wert:t},s=new TWEEN.Tween(i).to(n,1e3).onUpdate(function(){console.log(this.wert),this.wert>=minRadius?(a.style.width=maxRadius*this.wert/100+"px",a.style.height=maxRadius*this.wert/100+"px"):(a.style.width=maxRadius*minRadius/100+"px",a.style.height=maxRadius*minRadius/100+"px")}).easing(TWEEN.Easing.Back.In).start()}function animate(e){requestAnimationFrame(animate),TWEEN.update(e)}var statistikKey="tore",maxHelper={},maxRadius=90,minRadius=0,visualisationData={},options=["tore","gegentore","spielanzahl","alter","rot","gelb","qualifikationen","marktwert","kader","punkte","siege","gastgeber","twitter","landsize"],xmlhttp=new XMLHttpRequest,url="assets/data/data.json";xmlhttp.onreadystatechange=function(){if(4==xmlhttp.readyState&&200==xmlhttp.status){var e=JSON.parse(xmlhttp.responseText);formatData(e[0])}},xmlhttp.open("GET",url,!0),xmlhttp.send();for(var inputFields=document.getElementsByTagName("input"),i=0;i<inputFields.length;i++)inputFields[i].addEventListener("click",actionButton);requestAnimationFrame(animate);